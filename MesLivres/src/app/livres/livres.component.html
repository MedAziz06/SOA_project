<div class="container">
  <div class="card shadow-lg border-0 mb-4">
    <div class="card-header bg-gradient-primary text-white py-3">
      <div class="d-flex justify-content-between align-items-center">
        <h4 class="m-0">
          <i class="bi bi-book-fill me-2"></i>Liste des Livres
        </h4>
        <!-- Bouton "Nouveau Livre" uniquement pour les ADMIN -->
        @if(authService.isAdmin()) {
          <a routerLink="/add-livre" class="btn btn-light btn-sm">
            <i class="bi bi-plus-circle me-1"></i>Nouveau Livre
          </a>
        }
      </div>
    </div>
    <div class="card-body p-0">
      <!-- Message si aucune donnée -->
      @if (livres.length === 0) {
        <div class="text-center py-5">
          <i class="bi bi-inbox display-1 text-muted"></i>
          <h3 class="mt-3 text-muted">Aucun livre trouvé !</h3>
          <p class="text-muted">Vérifiez que le backend est démarré.</p>
          @if(authService.isAdmin()) {
            <a routerLink="/add-livre" class="btn btn-primary mt-3">
              <i class="bi bi-plus-circle me-2"></i>Ajouter un livre
            </a>
          }
        </div>
      }

      <!-- Affichage des livres -->
      @if (livres.length > 0) {
        <div class="table-responsive">
          <table class="table table-hover table-striped mb-0">
            <thead class="table-dark">
              <tr>
                <th>#</th>
                <th>ID</th>
                <th>Nom du Livre</th>
                <th>Prix</th>
                <th>Date de Création</th>
                <th>Auteur</th>
                <th class="text-center">Actions</th>
              </tr>
            </thead>
            <tbody>
              @for (livre of livres; track livre.idLivre; let index = $index) {
                <tr>
                  <td class="fw-bold">{{ index + 1 }}</td>
                  <td><span class="badge bg-secondary">{{ livre.idLivre }}</span></td>
                  <td>
                    <i class="bi bi-book text-primary me-2"></i>
                    {{ livre.nomLivre }}
                  </td>
                  <td><strong class="text-success">{{ livre.prixLivre }}€</strong></td>
                  <td>{{ livre.dateCreation | date: 'dd/MM/yyyy' }}</td>
                  <td>
                    @if (livre.auteur) {
                      <span class="badge bg-info text-dark">
                        <i class="bi bi-person-fill me-1"></i>
                        {{ livre.auteur.prenomAuteur }} {{ livre.auteur.nomAuteur }}
                      </span>
                    } @else {
                      <span class="badge bg-warning">PAS D'AUTEUR</span>
                    }
                  </td>
                  <td class="text-center">
                    <!-- Boutons Modifier/Supprimer uniquement pour les ADMIN -->
                    @if(authService.isAdmin()) {
                      <a [routerLink]="['/updateLivre', livre.idLivre]"
                         class="btn btn-warning btn-sm me-2"
                         title="Modifier">
                        <i class="bi bi-pencil-square"></i>
                      </a>
                      <button (click)="supprimerLivre(livre)"
                              class="btn btn-danger btn-sm"
                              title="Supprimer">
                        <i class="bi bi-trash"></i>
                      </button>
                    } @else {
                      <!-- Badge pour les utilisateurs non-admin -->
                      <span class="badge bg-secondary">
                        <i class="bi bi-lock-fill me-1"></i>Accès restreint
                      </span>
                    }
                  </td>
                </tr>
              }
            </tbody>
          </table>
        </div>
      }
    </div>
    @if (livres.length > 0) {
      <div class="card-footer bg-light">
        <small class="text-muted">
          <i class="bi bi-info-circle me-1"></i>
          Total : <strong>{{ livres.length }}</strong> livre(s)
        </small>
      </div>
    }
  </div>
</div>
